tasks:
  - name: retrieve_suppliers_task
    description: >
      Use the Serper tool to search for suppliers related to the input topic.
      Execute multiple search queries using the input topic, for example:
      - '{topic} reliable, potentials, top-rated potential wholesale distributors {country}'
      - '{topic} reliable, potentials, top-rated wholesale suppliers {country}'
      - '{topic} reliable, potentials, top-rated wholesale retailers {country}'
      Aggregate the results into a structured dataset including:
      - **Supplier name and description except 'Amazon'**
      - **Main website link**
      - **Any additional metadata or sitelinks**.
    expected_output: >
      A structured JSON containing supplier details:
      - `business_name`
      - `url`
      - `description`
      - `metadata` (if available).
    agent: retrieve_suppliers
    tools:
      - SerperSearchTool

  - name: domain_and_trustpilot_researcher_task
    description: >
      Using the CombinedTool, for each supplier from search results, perform the following:
      1. Fetch the domain age for the supplier website.
         - Ensure the input URL is properly formatted.
         - If a lookup fails, record a placeholder ('Check Manually').
      2. Retrieve Trustpilot review data.
         - Extract 'og:title' and 'AggregateRating' data.
         - If unavailable, return 'Check Manually'.
      3. Fetch ZoomInfo company data:
         - Extract fields such as name, URL, founding year, revenue, address, and contact number.
         - Extract email from the 'emailPatterns' field and include it as both 'contact_email' and 'email'.
         - If data is unavailable, record 'Check Manually'.
    expected_output: >
      A JSON dictionary mapping each supplier to its research data, for example:
      {
        'Supplier Name': {
          'website_url': 'https://www.example.com',
          'domain_age': '15 years',
          'trustpilot': {'trustpilot_rating': '4.2/5'},
          'zoominfo': {
            'name': 'Tesla',
            'url': 'www.tesla.com',
            'foundingYear': '2003',
            'revenue': '123',
            'address': '19266 Coastal Hwy, Delaware, US',
            'contact number': '(302) 786-5213',
            'contact_email': 'JSmith@tesla.com',
            'email': 'JSmith@tesla.com'
          }
        }
      }
    agent: domain_researcher_agent
    inputs:
      suppliers_data: retrieve_suppliers_task
    tools:
      - CombinedTool

  - name: ai_suppliers_write_task
    description: >
      Review the context you have received and expand each topic into a comprehensive section for a report.
      DO NOT include Amazon in the report.

      ❌ **EXCLUDE** platforms like Amazon, Reddit, Quora, eBay,BestBuy, Alibaba forums, and other non-supplier sources.
      The report should include:
      - Detailed descriptions of each supplier's business model and offerings.
      - Supplier's associated URL.
      - Domain age information (years since registration).
      - Trustpilot ratings and review insights.
      - Complete ZoomInfo details including name, URL, founding year, revenue, contact details, address, and other metadata.

      Additionally, include a markdown table summarizing key data:
      | Supplier Name | URL | Domain Age | Trustpilot Rating | Contact Email | Founding Year | Contact Details | Revenue | Employees | Address |
      |--------------|-----|------------|-------------------|--------------|---------------|----------------|---------|----------|---------|
      | Example Inc. | www.example.com | 10 years | 4.5/5 | contact@example.com | 2010 | (Phone, Email) | $100M | 500 | 1234 Example St, City, Country |
    expected_output: >
      A structured markdown report containing:
      - Sections covering each supplier with detailed insights.
      - Markdown-formatted tables summarizing key data points.
      - Clear and readable formatting with headings and bullet points.
    agent: ai_suppliers_writer
